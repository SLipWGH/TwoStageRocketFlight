
# <p style="text-align: center;">1. Содержательная постановка задачи</p>

Необходимо разработать математическую модель для полета двухступенчатой ракеты с учетом сопротивления воздуха в гравитационном поле Земли, позволяющую:

* Провести моделирование полета ракеты
* Выяснить условия достижения первой космической скорости при различных массах разгонных блоков;
* Провести анализ зависимости скорости полета от высоты;
* Провести анализ зависимости скорости полета от соотношения масс разгонных блоков.

За исходные данные примем:
1) Сухую массу ракеты $m_{rt_0}$
2) Сухую массу первой ступени $m_{st_1}$
3) Сухую массу второй ступени $m_{st_2}$
4) Площадь меделя ракеты $S_m$
5) Расход горючего и окислителя для каждой ступени
6) Соотношение масс окислителя и горючего в камере сгорания двигателей
7) Площадь сечения сопел на выходе $F_a$
8) Геометрическую степень расширения сопел $n_c$
9)  Давление в камере сгорания двигателей $P_0$
10) Температуру в камере сгорания двигателей $T_0$
11) Индивидуальные газовые постоянные для смесей топлива соответствующих ступеней



# <p style="text-align: center;">2. Содержательная постановка задачи</p>
Примем следующие допущения:

1) Форма планеты Земля принимается за шар с равномерно распределенной массой.
2) Вращением земли будем принебрегать.
3) В качестве основы модели ракеты рассмотрим РН "Saturn IB", т.е. будем считать что у нашей ракеты схожие характеристики (за исключением аэродинамических). Аэродинамические характеристики модели примем такие как у РН "Посейдон C-3".
4) Угол атаки на протяжении полета ракеты будем считать равным нулю и, следовательно, будем принебрегать подъемной силой и индуктивной составляющей силы лобового сопротивления.
5) Траектория полёта есть плоская кривая.
6) Точка запуска принимается на поверхности Земли на уровне моря.
7) Действием сторонних сил на ракету будем принебрегать.
8) Колебательным движением молекул при расчете числа степеней свободы газа будем принебрегать.
9) Будем считать, что атмосфера земли состоит из двухатомного газа до высоты 500 км, а после - из одноатомного.
10) Будем считать, что ракета достигает первой космической скорости, если выходит на орбиту по заданному закону изменения угла $\gamma$ (см. Пункт 3.4)


Задача о полете ракеты в гравитационном поле земли с учетом силы сопротивления $D$ представляет из себя задачу двух тел с учетом $D$.

При расчете силы тяжести - Землю можно считать точечной массой.

После того как аэродинамическая сила, действующая на ракету будет учтена, ракету тоже можно считать точечной массой (т.к угол атаки всегда равен нулю, моменты, связанные с центром масс ракеты возникать не будут, а т.к аэродинамическая сила уже учтена, то геометрия ракеты не играет никакой роли).

Движение ракеты происходит в поле силы тяжести с ускорением свободного падения, которое меняется в зависимости от высоты, набранной ракетой.
На ракету действует сила сопротивления воздуха, которая также будет изменяться в зависимости от параметров атмосферы на разной высоте, скорости, характерной площади и аэродинамических характеристик ракеты.
   

## <p style="text-align: center;">3. Математическая постановка задачи</p>

## 3.1 Атмосфера

Сначала небоходимо разобраться с параметрами атмосферы. Нас будут интересовать зависимости плостности $\rho(h)$, давления $P(h)$ и скорости распространения звука в среде $v_s(h)$ от высоты.


### 3.1.1 Плотность

Плотность $\rho$, кг·$м^{-3}$ , рассчитывается по давлению и температуре с
помощью уравнения состояния:
$$
\rho = \frac{pM}{RT} 
$$
где $R$ - универсальная газовая постоянная;
$M$ - молярная масса газа.

### 3.1.2 Молярная масса

Молярная масса до высоты 94 км постоянная и равна $M = M_c$. Далее с
увеличением высоты она уменьшается до 28,91 кг/кмоль на высоте 97000 м в
соответствии с выражением:

$$
M = 28, 82 + 0,158[1-7,5*10^{-8}(h-94000)^2]^{0.5}-2,479*10^{-4}(97000-h)^{0.5}
$$
Дальнейшее уменьшение до $h$ = 97500 и для 97500 $< h \le$ 120000 м
происходит по линейному закону с градиентами $\frac{dM}{dh}$ соответственно равными -0,00012 и -0,0001511 кг/(м·кмоль)

Интервал высот от 120000 до 1200000 м разбит на шесть участков, в
каждом из которых молярная масса аппроксимируется полиномом третьей
степени:
$$
M = B_0 + B_1h + B_2h^2 + B_3h^3
$$
где $B_o - B_3$ - коэффициенты полинома, представленные ниже.

![Alt text](image-6.png)

### 3.1.3 Температура

Соотношение между термодинамическими температурами Кельвина - и
Цельсия - выражаются формулой:

$$
T = T_0 + t
$$
где $T_0$ = 273,15 К - термодинамическая температура Кельвина для точки
таяния льда при давлении 101325 Па.

По характеру изменения температуры с высотой атмосферу принято
делить на несколько слоев: тропосферу, стратосферу, мезосферу,
термосферу и экзосферу. Для расчета параметров атмосферы на высотах до $h$ = 94000 м температура каждого слоя аппроксимируется линейной функцией
геопотенциальной высоты
$$
T = T_* + \beta(H-H_*)
$$

где $\beta$ = $\frac{dT}{dH}$ - градиент термодинамической температуры по геопотенциальной высоте (значения со "*" относятся к нижней границе рассматриваемого слоя).

Для удобства расчетов вводится понятие так называемой молярной
температуры $T_m$:
$$
T_M = \frac{TM_c}{M},
$$
которая изменяется линейно по геопотенциальной высоте и уравнение принимает вид:

$$
T_m = T_{M*} + \beta_M(H-H_*)
$$

где $\beta$ = $\frac{dT_M}{dH}$ - градиент молярной температуры по геопотенциальной высоте.

Значения температуры и ее вертикальных градиентов, принятые для
расчета параметров стандартной атмосферы до высоты $h$ = 120 км представлены в таблице ниже:

![Alt text](image-7.png)

Выше $h$ = 120 км принято кусочно-линейное изменение термодинамической
температуры по геометрической высоте
$$
T_M = T_* + \beta'(h-h_*)
$$

где $\beta'$ = $\frac{dT}{dh}$ 

![Alt text](image-8.png)

### 3.1.4 Геопотенциальная и геометрическая высота

Связь между геопотенциальной и геометрической высотой можно устанавливить следующим образом:

$$
H = \frac{rh}{r+h}
$$

$$
h = \frac{rH}{r - H}
$$

где

$h$ - геометическая высота;

$H$ - геопотенциальная высота.

### 3.1.5 Давление

Высоты от минус 2000 до 120000 м. При линейном изменении молярной температуры по геопотенциальной высоте решение уравнения статики атмосферы и уравнения состояния газа с использованием соотношений, представленных ранее, дает следующие расчетные формулы:
Для $\beta_M$ $\ne$ 0
$$
\lg p = \lg {p*} - \frac{g_c}{\beta_MR}\lg \frac{T_M + \beta_M(H-H_*)}{T_M*} 
$$

Для $\beta_M$ = 0
$$
\lg p = \lg {p*} - \frac{g_c}{\beta_MR} \frac{0,434294*g_c(H-H_*)}{RT}
$$


Высоты от 120000 до 1200000 м.
На высотах более 120 км, где принято кусочно-линейное изменение
кинетической температуры по геометрической высоте, давление $p$,
Па, удобно рассчитывать как функцию концентрации нейтральных частиц
воздуха $n$ и кинетической температуры $T$:
$$
p = \frac{nRT}{N_A}
$$

### 3.1.6 Концентрация частиц

На высотах более 120000 м концентрация частиц аппроксимируется
полиномом четвертой степени вида
$$
n = (A_0 + A_1h + A_2h^2 + A_3h^3 + A_4h^4)* 10^m,
$$
где коэффициенты $A_0-A_4$ и показатель степени $m$ в указанных интервалах приведены в таблице: 

![Alt text](image-9.png)

![Alt text](image-10.png)

### 3.1.7 Скорость звука

Скорость распространения звука к среде можно найти по формуле:

$$
v_s = \sqrt{-v^2k(\frac{\partial p}{\partial v})_T}
$$

где

$p$ - давление;

$k$ - коэффициент адиабаты;

$T$ - температура;

$v$ - удельный объем;

удельный объем $v = \frac{1}{\rho}$ где $\rho$ - плотность.

Из уравнение Менделеева - Клапейрона выразим давление $P$:

$$
P = \frac{\rho RT}{M} =\frac{RT}{vM}
$$

Откуда:

$$
\frac{\partial p}{\partial v} = -\frac{RT}{v^2M}
$$

тогда скорость звука:
$$
v_s = \sqrt{k \frac{RT}{M}}
$$

### 3.1.8 Коэффициент адиабаты
Для того чтобы расчитать коэффициент адиабаты для газа, состав которого будет меняться по мере набора высоты, необходимо знать число степеней свободы этого газа.

На уровне моря воздух состоит в основном из двухатомных молекул, а на больших высотах ($h > 500$ км в составе газа преобладают уже одноатомные молекулы)

С учетом допущения (8):

Число степеней свободы $i_1 = 3$, $i_2 = 5$ для одноатомного и двухатомного газа соответственно.

С учетом допущения (9) - мы знаем зависимость коэффициента адиабаты атмосферы земли от высоты:

$$
k = \frac{i+2}{i}
$$

$k_1 = \frac{7}{5}$, $k_2 = \frac{5}{3}$ - коэффициенты адиабаты атмосферы для высот до 500км и 1200км соответственно


## 3.2 Сила сопротивления

Вектор аэродинамического сопротивления складывается из двух компонент
$$
\overrightarrow{R} = \overrightarrow{D} + \overrightarrow{L}
$$

где $\overrightarrow{D}$ - вектор силы лобового сопротивления, $\overrightarrow{L}$ - вектор подъемной силы.

Аэродинамическое сопротивление с учетом допущения (4) вычисляется по формуле:

$$
D = C_x\frac{\rho v^2}{2}S
$$
где 

$C_x$ - коэффициент лобового аэродинамического сопротивления; 

$\rho$ - плотность атмосферы; 

$v$ - скорость движения в среде;

$S$ - характерная площадь.

Коэффициент $C_x$ для ракеты "Посейдон С-3" определяется по таблице в зависимости от высоты и числа маха:

![Alt text](image-2.png)

За неимением большего количества данных, будем считать, что на высоте $h > 60$ км коэффициент такой же как на высоте $60$ км

Число Маха, в свою очередь, зависит от скорости звука и равно отношению скорости движения в среде к скорости распространения звука в ней:

$$
M(v, v_s)=\frac{v}{v_s}.
$$

## 3.3 Сила тяжести

В соответствии с законом всемирного тяготения, величина гравитационного ускорения на поверхности Земли или космического тела связана с его массой M следующим соотношением:

$$
g = G\frac{M}{r^2}
$$
где 

$G$ - гравитационная постоянная ($6.674 \times 10^{-11}м^3\timesс^{-2}\timesкг^{-1}$); 

$M$ - масса планеты $(5,9722 ± 0,0006) × 1024 кг$; 

$r$ - радиус планеты ($6371.0 км$).

Гравитационное ускорение на высоте h над поверхностью Земли можно вычислить по формуле:

$$
g(h) = \frac{GM}{(r+h)^2}
$$

## 3.4 Тяга двигателей

Теперь перейдем к расчету силы тяги двигателей:

Сила тяги двигателя вычисляется по формуле:

$$
P_T = \dot{m}v_a + F_a(p_a - p_h)
$$
где $\dot{m}$ - массовый расход топлива РД в секунду; 
$v_a$ - скорость продуктов сгорания на срезе сопла; 
$F_a$ - площадь выходного сечения сопла; 
$p_a$ - давление на срезе сопла; 
$p_h$ - давление окружающей среды;

Скорость продуктов сгорания на срезе сопла при условии адиабатического течения потока продуктов сгорания в сопле можно расчитать по формуле:

$$
v_a = \sqrt{\frac{2k}{k-1}R_гT_0(1-\frac{1}{\epsilon_c^\frac{k-1}{k}})}
$$
где $\epsilon_c$ - степень расширения сопла по давлению, равная отношению давления в камере сгорания и давления на срезе сопла, т.е $\epsilon_c = \frac{p_0}{p_a}$ ($p_0$ - давление в камере сгорания); 
$k$, $R_г$, $T_0$ - характеристики продуктов сгорания: соответственно коэффициент адиабаты, индивидуальная газовая постоянная и температура продуктов сгорания в камере.

Сопло также характеризуется другим параметром - геометрической степенью расширения $n_c = \frac{F_a}{F_{кр}}$, где $F_{кр}$ - площадь критического сечения сопла.

$\epsilon_c$ и $n_c$ связаны соотношением:

$$
n_c = \frac{\sqrt{\frac{k-1}{k+1}(\frac{2}{k+1})^\frac{1}{k-1}}}{\sqrt{(\frac{1}{\epsilon_c})^\frac{2}{k} - (\frac{1}{\epsilon_c})^\frac{k+1}{k}}}
$$

Секундный массовый расход можно расчитать по формуле:

$$
\dot{m} = \frac{a_kp_0F{кр}}{\sqrt{R_гT_0}}
$$

где коэффициент $a_k = \sqrt{k}(\frac{2}{k+1})^\frac{k+1}{2(k-1)}$ 

В качестве маршевых двигателей первой ступени ракеты "Saturn - IB" используются 8 ЖРД "H-1", в качестве топлива используется смесь LOX + RP-1 (жидкий кислород и рафинированный керосин).
Исходя из информации, которую удалось найти в свободном доступе, параметры двигателя следующие:

* Коэффициент адиабаты $k=1.25$ 
* Индивидуальная газовая постоянная смеси $R_г=340 \frac{Дж}{кг\timesК}$
* Температура продуктов сгорания в камере $T_0\approx 3831$ К
* Геометрическая степень расширения сопла $n_c = 8$
* Площадь выходного сечения сопла $F_a\approx 1.1033 м^2$
* Давление в камере сгорания $p_0=4.36 МПа$

Исходя из этих параметров найдем:

* Коэффициент $a_k \approx 0.658$
* Площадь критического сечения сопла $F_{кр}\approx 0.137915 м^2$
* Степень расширения сопла по давлению $\epsilon_c \approx 69.567$ (аппроксимирующая формула для $k=1.25$ $\epsilon_c \approx 4.6089n_c^{1.3053}$)
* Скорость продуктов сгорания в выходном сечении сопла $v_a \approx 2729.388 \frac{м}{с}$
* Секундный массовый расход $\dot{m} \approx 346.68 \frac{кг}{с}$

Тогда сила тяги одного двигателя первой ступени на уровне моря $P_T \approx 909.15 кН$, что примерно соответствует $910$ кН по данным с ресурса "Википедия".

В качестве маршевого двигателя второй ступени ракеты "Saturn - IB" используются ЖРД "J-2", которые в качестве топлива потребляют смесь LOX + LH2 (жидкий кислород и жидкий водород).
Исходя из информации, которую удалось найти в свободном доступе, параметры двигателя следующие:

* Коэффициент адиабаты $k=1.19$ 
* Индивидуальная газовая постоянная смеси $R_г=600.34 \frac{Дж}{кг\timesК}$
* Температура продуктов сгорания в камере $T_0\approx 3523$ К
* Геометрическая степень расширения сопла $n_c = 27.5$
* Площадь выходного сечения сопла $F_a\approx 2.01 м^2$
* Давление в камере сгорания $p_0=5.366 МПа$

Исходя из этих параметров найдем:

* Коэффициент $a_k \approx 0.6474$
* Площадь критического сечения сопла $F_{кр}\approx 0.103 м^2$
* Степень расширения сопла по давлению $\epsilon_c \approx 279.233$ (аппроксимирующая формула для $k=1.19$ $\epsilon_c \approx 4.3066n_c^{1.2588}$)
* Скорость продуктов сгорания в выходном сечении сопла $v_a \approx 3974.22 \frac{м}{с}$
* Секундный массовый расход $\dot{m} \approx 246.45 \frac{кг}{с}$

Тогда сила тяги двигателя второй ступени в вакууме $P_T \approx 1018$ кН


## 3.5 Динамика
Запишем основное уравнение динамики с учетом силы сопротивления:

$$
m\overrightarrow{a} = \overrightarrow{P_T} + \overrightarrow{G} + \overrightarrow{R}
$$
где
$m$ - масса ракеты;
$\overrightarrow{a}$ - вектор ускорения; 
$\overrightarrow{P_T}$ - вектор силы тяги двигателя; 
$\overrightarrow{G}$ - вектор силы тяжести; 
$\overrightarrow{R}$ - сила сопротивления атмосферы.

![alt text](image.png)


Вектор силы тяжести $\overrightarrow{G}$ направлен к центру Земли.
Вектор силы тяги двигателя направлен вдоль продольной оси ракеты.
Вектор аэродинамической силы (в нашем случае равный векторы силы лобового сопротивления)  направлен по касательной к траектории ракеты и противонаправлен скорости ракеты.

Выразив ускорение через нормальную и тангенциальную состовляющие, получим систему уравнений:


$$
\begin{cases}
\dot v = \frac{T}{m} - \frac{D}{m} - g\sin\gamma\\

v\dot\gamma = -(g - \frac{v^2}{r_0+h})\cos\gamma
\end{cases}
$$

где $\gamma$ - угол между локальной горизонтальной осью и вектором скорости ракеты;

$r_0$ - радиус Земли;

$h(t) = \int^{t}_{t_0}v\sin\gamma dt$ - высота над поверхностью земли.

Доопределим систему уравнениями:

$s(t) = \int^{t}_{t_0}\frac{r_0}{r_0+h}v\cos\gamma dt$ - проекция перемещения ракеты на поверхность земли.

$\dot m = C(t)$, 
$C(t) =\begin{cases}
    C_1, t< t_1\\
    C_2, t< t_2
\end{cases}$, 

где $C_1$, $t_1$, $C_2$, $t_2$ - массовый расход и время работы для первой и второй степеней соответственно. 

В любой момент можно перейти к декартовой системе координат с началом координат, расположенным в центре земли в любой момент времени, сдвинув систему координат по $OY$ на $-r_0$ и повернув на величину $\frac{s(t)}{2\pi r_0}$ против часовой стрелки.

Закон изменения $\gamma$ построим по аналогии с законом, аппроксимирующим реальный полет ракеты "Saturn-V":

$$
sin\gamma =\begin{cases}
    1, 0\le t \le 30.2\\
    1.15 - 0.005t, 30.2 \le t \le 144
\end{cases}
$$

$$
sin\gamma = 1.54\exp{\frac{-t}{109}}, 144 \le t \le 228.08
$$

После этого закон изменения $\gamma$ будет представлять из себя второе уравнение системы, пока не станет меньше 0.001 рад; 

Далее будем изменять $\gamma$ линейно: $\dot \gamma = -\frac{\gamma}{10}$.

Предложенная траектория ракеты, очевидно, не будет оптимальной, однако нахождение таковой представляет собой весьма сложную задачу, требующую знаний механики управляемых систем.

Так же, необходимо будет выключать двигатель ракеты, если скорость превысила первую космическую для данной высоты (будем делать это, если скорость стала на 5 м/c больше первой космической). Тогда, даже если в момент времени, когда ракета "ляжет в горизонт" - скорость будет превышать первую космическую (не более чем на 5 м/c), то орбита будет почти идеальной круговой, т.к небольшой избыток скорости даст лишь небольшое эллиптическое искривление орбиты.

## 4. Результаты

Работоспособность модели продемонстрируем для параметров ракеты, приведенных на ресурсе "Википедия":
Масса ракеты $m_{r,0} = 20170$ км;

Сухая масса первой ступени $m_{st_1, 0} = 42000$ кг;

Масса топлива первой ступени $m_{st_1} = 399400$ кг;

Сухая масса второй ступени $m_{st_2,0} = 10600$ кг;

Масса топлива второй ступени $m_{st_2,0} = 103600 кг$;

Площадь меделя ракеты $S\approx 34.3156 м^2$.

### Графики зависимости $h(t)$, $v(t)$, $\gamma(t)$, $v(h)$:

![alt text](image-1.png)

### Траектория ракеты относительно Земли:

![alt text](image-5.png)

![alt text](image-4.png)

Как видим, орбита близка к идеальной круговой. 

